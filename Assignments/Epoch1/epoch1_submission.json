{
    "binaries": [
        {
            "binary_name": "suspicous.epoch1.exe",
            "sha256": "4a548f161dfbda599686c15c56bd81eab176668cfab00bc31df31fe2032e8343",
            "imphash": "8ff386ea4029e407f75e80606cb72508",
            "arch": 64,
            "compile_time": 1708400206,
            "strings": [
                "!This program cannot be run in DOS mode. $",
                "1337ch0nH",
                "ExamMonitor.dll",
                "https://exam.gradescopech0nky.com/StartExam",
                "StartExam",
                "FLAG{TodaysQuizWhyIsNotepadDoingNetworkIO}",
                "C:\\malware\\ch0nky.txt",
                "kernel32",
                "LoadLibraryW"
            ],
            "imports": {
                "KERNEL32.dll": [
                    "CloseHandle",
                    "CreateProcessW",
                    "CreateRemoteThread",
                    "FreeConsole",
                    "FreeLibrary",
                    "GetFileAttributesA",
                    "GetModuleHandleA",
                    "GetProcAddress",
                    "GetStartupInfoA",
                    "GetTempPathW",
                    "LoadLibraryW",
                    "Sleep",
                    "TlsGetValue",
                    "VirtualAllocEx",
                    "VirtualFreeEx",
                    "VirtualProtect",
                    "VirtualQuery",
                    "WriteProcessMemory"
                ],
                "PSAPI.DLL": [
                    "EnumProcessModules",
                    "GetModuleFileNameExW"
                ],
                "SHLWAPI.dll": [
                    "PathCombineW"
                ],
                "WININET.dll": [
                    "DeleteUrlCacheEntryW"
                ],
                "urlmon.dll": [
                    "URLDownloadToFileW",
                    "UrlMkSetSessionOption"
                ]
            },
            "iocs": [
                {
                    "type": "URL",
                    "Value": "https://exam.gradescopech0nky.com/StartExam",
                    "Comments": "URL found in PE strings"
                },
                {
                    "type": "DLL",
                    "Value": "ExamMonitor.dll",
                    "Comments": "DLL that does not exist in the current PE"
                },
                {
                    "type": "domain",
                    "Value": "exam.gradeschopech0nky.com",
                    "Comments": "C2 server domain"
                },
                {
                    "type": "IP",
                    "Value": "64.225.59.165",
                    "Comments": "IP addr of C2 server"
                },
                {
                    "type": "file_name",
                    "Value": "C:\\malware\\ch0nky.txt",
                    "Comments": "signature check for ch0nky.txt before execution"
                },
                {
                    "type": "DLL_exported_function",
                    "Value": "StartExam",
                    "Comments": "exported function that is called after DLL is downloaded"
                }
            ],
            "mitre_att&ck": {
                "TA0005": {
                    "Techniques": [
                        "T1564",
                        "T1055",
                        "T1480"
                    ],
                    "Comments": "calling FreeConsole, the injection and execution of ExamMonitor.dll, checking of ch0nky.txt before execution"
                },
                "TA0002": {
                    "Techniques": [
                        "T1106",
                        "T1559"
                    ],
                    "Comments": "using remote threading to execute ExamMonitor.dll"
                },
                "TA0040": {
                    "Techniques": [
                        "T1565"
                    ],
                    "Comments": "downloading of ExamMonitor.dll and injection into system"
                }
            },
            "verdict": true,
            "classification": "dropper",
            "verdict_justification": "loads and runs StartExam"
        },
        {
            "binary_name": "ExamMonitor.dll",
            "sha256": "7b445bf8e7e6d1b00d62a810b2462f426d8dde4ba01a8dff994ff24b1fe10212",
            "imphash": "7130f486d66d68ca3145bd8bc1516d6b",
            "arch": 64,
            "compile_time": 1708400225,
            "strings": [
                "notepad.H",
                "kernel32H",
                "IsDebuggH",
                "erPresenH",
                "l bug reI",
                "not enouI",
                "gh spaceH",
                "for forH",
                "mat expaI",
                "nsion (PI",
                "lease suI",
                "bmit fulH",
                "https://L)",
                "port at H",
                "gcc.gnu.H",
                "org/bugsH",
                "/): H",
                "l bug reH)",
                "bmit fulH",
                "https://H",
                "port at H",
                "org/bugsH",
                "gcc.gnu.H",
                "AUATH",
                "1337ch0nky",
                "auth=",
                "1337ch0nky",
                "&guid=",
                "&user=",
                "&computer=",
                "/register.php",
                "gradescopech0nky.com",
                "1337ch0nky",
                "/checkin.php",
                "<ch0nky>",
                "register",
                "execute",
                "no args",
                "inject",
                "Unknown command",
                "vector::_M_realloc_insert",
                "basic_string::_M_construct null not valid",
                "/c \\Windows\\system32\\schtasks.exe /create /tn \"",
                "WindwosUpdate",
                "\" /sc minute /mo 1 /tr 'rundll32.exe",
                "StartExam",
                "Authorization:",
                "Content-Type: application/x-www-form-urlencoded",
                "cannot create std::vector larger than max_size()",
                "vector::_M_default_append",
                "basic_string::_M_construct null not valid",
                "powershell.exe /c",
                "Buffer component: %s",
                "SOFTWARE\\Microsoft\\Cryptography",
                "MachineGuid",
                "Unknown",
                "FLAG{TotallyLegitMutex}",
                "C:\\malware\\ch0nky.txt",
                "Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                "ch0nky",
                "cannot create std::vector larger than max_size()",
                "basic_string::_M_construct null not valid",
                "0123456789abcdef",
                "vector::_M_realloc_insert",
                "what():",
                "0123456789",
                "basic_string::_M_create",
                "backdoor.dll"
            ],
            "imports": {
                "ADVAPI32.dll": [
                    "GetUserNameA",
                    "RegCloseKey",
                    "RegOpenKeyExA",
                    "RegQueryValueExA",
                    "RegSetValueExA"
                ],
                "KERNEL32.dll": [
                    "CreatePipe",
                    "CreateProcessA",
                    "CreateThread",
                    "FreeConsole",
                    "GetComputerNameA",
                    "GetCurrentThreadId",
                    "GetProcAddress",
                    "LoadLibraryW",
                    "Sleep",
                    "SuspendThread",
                    "WriteProcessMemory"
                ],
                "SHELL32.dll": [
                    "ShellExecuteA"
                ],
                "WINHTTP.dll": [
                    "WinHttpCloseHandle",
                    "WinHttpConnect",
                    "WinHttpOpen",
                    "WinHttpOpenRequest",
                    "WinHttpQueryDataAvailable",
                    "WinHttpReadData",
                    "WinHttpReceiveResponse",
                    "WinHttpSendRequest",
                    "WinHttpSetOption"
                ]
            },
            "iocs": [
                {
                    "type": "scheduled_task",
                    "Value": "WindwosUpdate",
                    "Comments": "incorrectly spelled 'WindowsUpdate' task"
                },
                {
                    "type": "URL",
                    "Value": "gradescopech0nky.com/login.php",
                    "Comments": null
                },
                {
                    "type": "URL",
                    "Value": "gradescopech0nky.com/checkin.php",
                    "Comments": null
                },
                {
                    "type": "PE_string",
                    "Value": "inject",
                    "Comments": "indicates something is being executed or injected"
                },
                {
                    "type": "file_name",
                    "Value": "C:\\malware\\ch0nky.txt",
                    "Comments": "signature check for ch0nky.txt before execution"
                }
            ],
            "mitre_att&ck": {
                "TA0007": {
                    "Techniques": [
                        "T1012",
                        "T1082",
                        "T1087"
                    ],
                    "Comments": "for registry query functions, GetComputerNameA, and GetUserNameA"
                },
                "TA0005": {
                    "Techniques": [
                        "T1564",
                        "T1622",
                        "T1140",
                        "T1055",
                        "T1480",
                        "for FreeConsole, isDebuggerPresent & extended sleep calls, for decryption of C2 commands, data injection into notepad.exe on 'inject' commands from C2, and check for ch0nky.txt before execution"
                    ]
                },
                "TA0002": {
                    "Techniques": [
                        "T1106",
                        "T1053",
                        "T1059",
                        "T1559",
                        "for using windows api, ScheduleTaskA and rundll32 to schedule StartExam to run, using 'cmd' to execute things, and piping responses from powershell execution"
                    ]
                },
                "TA0003": {
                    "Techniques": [
                        "T1547"
                    ],
                    "Comments": "adds ExamMonitor.dll to WinRegistry to run on user login"
                },
                "TA0011": {
                    "Techniques": [
                        "T1573",
                        "T1071"
                    ],
                    "Comments": "uses Rc4 encryption/decryption between C2 server, uses HTTPS and standard port 443 for communcation"
                }
            },
            "verdict": true,
            "classification": "remote_access_trojan",
            "verdict_justification": "schedules the StartExam function to run and report back to the C2 server every minute"
        }
    ],
    "Flags": [
        "FLAG{TodaysQuizWhyIsNotepadDoingNetworkIO}",
        "FLAG{TotallyLegitMutex}"
    ],
    "C2s": [
        [
            "exam.gradeschopech0nky.com",
            "64.225.59.165"
        ]
    ]
}