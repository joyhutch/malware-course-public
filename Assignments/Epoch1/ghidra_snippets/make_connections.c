
longlong *
make_connections(longlong *param_1,
                undefined8 *user_agent,
                undefined8 *server_name,
                undefined2 port_num,
                wchar_t **post_verb,
                undefined8 *register_php,
                char param_7, // \x01
                char param_8, // \x01
                longlong *param_9,
                undefined8 *param_10)

{
  bool bVar1;
  int iVar2;
  undefined8 str_var;
  undefined8 POST_var;
  longlong lVar3;
  undefined8 in_stack_fffffffffffffe88;
  uint uVar5;
  ulonglong uVar4;
  ulonglong uVar6;
  undefined8 in_stack_fffffffffffffe98;
  undefined4 uVar7;
  void *local_148 [4];
  void *local_128 [4];
  int local_104;
  undefined4 local_100;
  undefined4 local_fc;
  void *local_f8 [4];
  void *local_d8 [6];
  void *local_a8 [6];
  void *local_78 [4];
  uint local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  longlong hRequest;
  longlong hConnection;
  longlong hSession;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  
  uVar7 = (undefined4)((ulonglong)in_stack_fffffffffffffe98 >> 0x20);
  uVar5 = (uint)((ulonglong)in_stack_fffffffffffffe88 >> 0x20);
  return_func();
  some_buff_cpy_func((longlong *)local_d8,"");
  _another_return();
  FUN_30d4b3fc0(local_a8,param_9);
  some_concat_func((longlong *)local_d8,local_a8);
  free_var(local_a8);
  str_var = FUN_30d4c8ca0((longlong)local_d8);
  local_24 = (undefined4)str_var;
  hSession = 0;
  hConnection = 0;
  hRequest = 0;
  local_1c = 0;
  str_var = FUN_30d4c9a60(user_agent);
  hSession = WinHttpOpen(str_var,0,0,0,(ulonglong)uVar5 << 0x20);
  if (hSession == 0) {
    return_func();
    some_buff_cpy_func(param_1,"");
    _another_return();
  }
  else {
    str_var = FUN_30d4c9a60(server_name);
    hConnection = WinHttpConnect(hSession,str_var,port_num,0);
    if (hConnection == 0) {
      WinHttpCloseHandle(hSession);
      return_func();
      some_buff_cpy_func(param_1,"");
      _another_return();
    }
    else {
      local_20 = 0x100;
      if (param_7 != '\0') {
        local_20 = 0x800100;
      }
      str_var = FUN_30d4c9a60(register_php);
      POST_var = FUN_30d4c9a60(post_verb);
      uVar6 = 0;
      uVar4 = 0;
      hRequest = WinHttpOpenRequest(hConnection,POST_var,str_var,0,0,0,CONCAT44(uVar7,local_20));
      if (hRequest == 0) {
        WinHttpCloseHandle(0);
        WinHttpCloseHandle(hSession);
        WinHttpCloseHandle(hConnection);
        return_func();
        some_buff_cpy_func(param_1,"");
        _another_return();
      }
      else {
        if (param_8 != '\x01') {
          local_fc = 0x3300;
          iVar2 = WinHttpSetOption(hRequest,0x1f,&local_fc,4);
          if (iVar2 == 0) {
            WinHttpCloseHandle(hRequest);
            WinHttpCloseHandle(hSession);
            WinHttpCloseHandle(hConnection);
          }
        }
        bVar1 = FUN_30d4d8c20(post_verb,L"POST");
        if (bVar1) {
          ret_func();
          FUN_30d4d6800((longlong *)local_148,L"Authorization: ");
          another_ret_func();
          FUN_30d4d5440((longlong *)local_148,param_10);
          FUN_30d4d52b0((longlong *)local_148,L"\r\n");
          FUN_30d4d52b0((longlong *)local_148,L"Content-Type: application/x-www-form-urlencoded\r\n"
                       );
          local_44 = 0xffffffff;
          str_var = FUN_30d4c8cc0(local_d8);
          POST_var = FUN_30d4c9a60(local_148);
          local_1c = WinHttpSendRequest(hRequest,POST_var,local_44,str_var,local_24,local_24,0);
          free_param_1(local_148);
        }
        else {
          local_1c = WinHttpSendRequest(hRequest,0,0,0,uVar4 & 0xffffffff00000000,
                                        uVar6 & 0xffffffff00000000,0);
        }
        FUN_30d4d3590((longlong *)local_f8);
        local_48 = 0;
        local_4c = 4;
        if (local_1c != 0) {
          local_100 = 0;
          local_1c = WinHttpReceiveResponse(hRequest,0);
          local_104 = 0;
          local_50 = 0;
          return_func();
          FUN_30d4d0420(local_128,0);
          _another_return();
          do {
            local_104 = 0;
            WinHttpQueryDataAvailable(hRequest,&local_104);
            if (local_104 == 0) break;
            lVar3 = FUN_30d4c8120((longlong *)local_128);
            local_54 = (uint)lVar3;
            FUN_30d4d03a0(local_128,(ulonglong)(local_54 + local_104));
            iVar2 = local_104;
            lVar3 = FUN_30d4d04f0((longlong *)local_128,(ulonglong)local_54);
            WinHttpReadData(hRequest,lVar3,iVar2,&local_100);
          } while (local_104 != 0);
          return_func();
          str_var = FUN_30d4d0340((longlong)local_128);
          lVar3 = FUN_30d4d0370(local_128);
          FUN_30d4d36f0((longlong *)local_78,lVar3,str_var);
          FUN_30d4d3ea0(local_f8,local_78);
          free_var(local_78);
          _another_return();
          FUN_30d4d04a0(local_128);
        }
        WinHttpCloseHandle(hRequest);
        WinHttpCloseHandle(hSession);
        WinHttpCloseHandle(hConnection);
        FUN_30d4d3200(param_1,(longlong *)local_f8);
        free_var(local_f8);
      }
    }
  }
  free_var(local_d8);
  return param_1;
}


