
void FUN_30d4b292c(longlong param_1,ulonglong param_2,longlong param_3,ulonglong param_4)

{
  byte local_128 [263];
  byte local_21;
  ulonglong local_20;
  int local_18;
  uint local_14;
  uint local_10;
  int local_c;
  
  for (local_c = 0; local_c < 0x100; local_c = local_c + 1) {
    local_128[local_c] = (byte)local_c;
  }
  local_10 = 0;
  local_14 = 0;
  for (local_18 = 0; local_18 < 0x100; local_18 = local_18 + 1) {
    local_14 = (int)((uint)*(byte *)(param_1 + (ulonglong)(longlong)(int)local_10 % param_2) +
                    local_128[(int)local_10] + local_14) % 0x100;
    FUN_30d4b28f0(local_128 + (int)local_10,local_128 + (int)local_14);
    local_10 = local_10 + 1;
  }
  local_10 = 0;
  local_14 = 0;
  for (local_20 = 0; local_20 < param_4; local_20 = local_20 + 1) {
    local_10 = local_10 + 1 & 0xff;
    local_14 = local_14 + local_128[(int)local_10] & 0xff;
    FUN_30d4b28f0(local_128 + (int)local_10,local_128 + (int)local_14);
    local_21 = local_128[(int)(uint)(byte)(local_128[(int)local_14] + local_128[(int)local_10])];
    *(byte *)(local_20 + param_3) =
         *(byte *)(local_20 + param_3) ^
         local_128[(int)(uint)(byte)(local_128[(int)local_14] + local_128[(int)local_10])];
  }
  return;
}


